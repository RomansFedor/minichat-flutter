# üìÑ –ü–û–Ø–°–ù–ï–ù–ù–Ø –ö–û–î–£ –ü–û –§–ê–ô–õ–ê–•

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ—î–∫—Ç—É MiniChat

---

# üìã –ó–ú–Ü–°–¢

1. [–ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É](#1-–∑–∞–≥–∞–ª—å–Ω–∞-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ—î–∫—Ç—É)
2. [–ö–æ—Ä–µ–Ω–µ–≤–∞ –ø–∞–ø–∫–∞ (lib/)](#2-–∫–æ—Ä–µ–Ω–µ–≤–∞-–ø–∞–ø–∫–∞-lib)
3. [Core –º–æ–¥—É–ª—ñ](#3-core-–º–æ–¥—É–ª—ñ)
4. [Features –º–æ–¥—É–ª—ñ](#4-features-–º–æ–¥—É–ª—ñ)
5. [–ó–≤'—è–∑–∫–∏ –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏](#5-–∑–≤—è–∑–∫–∏-–º—ñ–∂-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏)

---

# 1. –ó–ê–ì–ê–õ–¨–ù–ê –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£

```
lib/
‚îú‚îÄ‚îÄ main.dart                          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–æ–¥–∞—Ç–∫—É
‚îú‚îÄ‚îÄ firebase_options.dart              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Firebase
‚îú‚îÄ‚îÄ core/                              # –ë–∞–∑–æ–≤—ñ —É—Ç–∏–ª—ñ—Ç–∏ —Ç–∞ —Å–µ—Ä–≤—ñ—Å–∏
‚îÇ   ‚îú‚îÄ‚îÄ app_theme.dart                # –¢–µ–º–∏ —Ç–∞ –∫–æ–ª—å–æ—Ä–∏
‚îÇ   ‚îú‚îÄ‚îÄ auth_repository.dart          # –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
‚îÇ   ‚îî‚îÄ‚îÄ storage_service.dart          # –õ–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ (SharedPreferences)
‚îî‚îÄ‚îÄ features/                          # –ú–æ–¥—É–ª—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ
    ‚îú‚îÄ‚îÄ auth/                          # –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
    ‚îÇ   ‚îú‚îÄ‚îÄ auth_screen.dart
    ‚îÇ   ‚îî‚îÄ‚îÄ settings_section.dart
    ‚îú‚îÄ‚îÄ chats/                         # –ß–∞—Ç–∏
    ‚îÇ   ‚îú‚îÄ‚îÄ bloc/                      # BLoC –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω–æ–º
    ‚îÇ   ‚îú‚îÄ‚îÄ models/                    # –ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö
    ‚îÇ   ‚îú‚îÄ‚îÄ repositories/              # –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Firestore
    ‚îÇ   ‚îú‚îÄ‚îÄ chats_screen.dart
    ‚îÇ   ‚îú‚îÄ‚îÄ chat_room_screen.dart
    ‚îÇ   ‚îî‚îÄ‚îÄ saved_messages_screen.dart
    ‚îú‚îÄ‚îÄ contacts/                      # –ö–æ–Ω—Ç–∞–∫—Ç–∏
    ‚îÇ   ‚îú‚îÄ‚îÄ contacts_screen.dart
    ‚îÇ   ‚îú‚îÄ‚îÄ contact_detail_screen.dart
    ‚îÇ   ‚îî‚îÄ‚îÄ models/
    ‚îî‚îÄ‚îÄ widgets/                       # –°–ø—ñ–ª—å–Ω—ñ –≤—ñ–¥–∂–µ—Ç–∏
        ‚îî‚îÄ‚îÄ message_bubble.dart
```

---

# 2. –ö–û–†–ï–ù–ï–í–ê –ü–ê–ü–ö–ê (lib/)

## 2.1. `main.dart` - –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–æ–¥–∞—Ç–∫—É

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª, —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î Flutter –¥–æ–¥–∞—Ç–æ–∫ —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –≤—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏.

### –ö–ª—é—á–æ–≤—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:

#### `main()` —Ñ—É–Ω–∫—Ü—ñ—è
```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  
  FlutterError.onError = FirebaseCrashlytics.instance.recordFlutterFatalError;
  
  runZonedGuarded<Future<void>>(
    () async => runApp(const MiniChatApp()),
    (error, stack) => FirebaseCrashlytics.instance.recordError(error, stack, fatal: true),
  );
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- `WidgetsFlutterBinding.ensureInitialized()` - —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î Flutter –ø–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Firebase
- `Firebase.initializeApp()` - –ø—ñ–¥–∫–ª—é—á–∞—î Firebase –¥–æ –ø—Ä–æ—î–∫—Ç—É
- `FlutterError.onError` - –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫ —á–µ—Ä–µ–∑ Crashlytics
- `runZonedGuarded` - –æ–±–≥–æ—Ä—Ç–∞—î –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –ø–æ–º–∏–ª–æ–∫

#### `MiniChatApp` –∫–ª–∞—Å
```dart
class MiniChatApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MultiBlocProvider(
      providers: [
        BlocProvider(
          create: (context) => ChatsBloc(),
        ),
      ],
      child: MaterialApp(...),
    );
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- `MultiBlocProvider` - –Ω–∞–¥–∞—î BLoC –≤—Å—ñ–º –¥–æ—á—ñ—Ä–Ω—ñ–º –≤—ñ–¥–∂–µ—Ç–∞–º
- `MaterialApp` - –∫–æ—Ä–µ–Ω–µ–≤–∏–π –≤—ñ–¥–∂–µ—Ç Material Design –¥–æ–¥–∞—Ç–∫—É
- –ù–∞–ª–∞—à—Ç–æ–≤—É—î —Ç–µ–º—É –¥–æ–¥–∞—Ç–∫—É –∑ –∫–æ–ª—å–æ—Ä–∞–º–∏ —Ç–∞ —Å—Ç–∏–ª—è–º–∏

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–µ–º–∏:**
- `colorSchemeSeed` - –±–∞–∑–æ–≤–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–∞–ª—ñ—Ç—Ä–∏
- `useMaterial3` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Material Design 3
- `appBarTheme` - —Å—Ç–∏–ª—ñ –¥–ª—è AppBar

#### `MainWrapper` –∫–ª–∞—Å
```dart
class MainWrapper extends StatefulWidget {
  // –£–ø—Ä–∞–≤–ª—è—î –Ω–∞–≤—ñ–≥–∞—Ü—ñ—î—é –º—ñ–∂ –µ–∫—Ä–∞–Ω–∞–º–∏
}

class _MainWrapperState extends State<MainWrapper> {
  int _selectedIndex = 0; // –Ü–Ω–¥–µ–∫—Å –ø–æ—Ç–æ—á–Ω–æ—ó –≤–∫–ª–∞–¥–∫–∏
  
  Widget _getCurrentScreen() {
    switch (_selectedIndex) {
      case 0: return const ChatsScreen();
      case 1: return const ContactsScreen();
      case 2: return AuthScreen(onLoginSuccess: _onLoginSuccess);
    }
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ö–µ—Ä—É—î –Ω–∏–∂–Ω—å–æ—é –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω–æ—é –ø–∞–Ω–µ–ª–ª—é (bottomNavigationBar)
- –ü–µ—Ä–µ–º–∏–∫–∞—î –º—ñ–∂ —Ç—Ä—å–æ–º–∞ –µ–∫—Ä–∞–Ω–∞–º–∏: –ß–∞—Ç–∏, –ö–æ–Ω—Ç–∞–∫—Ç–∏, –ü—Ä–æ—Ñ—ñ–ª—å
- –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ª–æ–≥—ñ–Ω—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—î –Ω–∞ –ø–µ—Ä—à—É –≤–∫–ª–∞–¥–∫—É
- –ú—ñ—Å—Ç–∏—Ç—å AppBar –∑ –∫–Ω–æ–ø–∫–æ—é —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è Crashlytics

**–í–∞–∂–ª–∏–≤—ñ –º–µ—Ç–æ–¥–∏:**
- `_onLoginSuccess()` - –∫–æ–ª–±–µ–∫, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ª–æ–≥—ñ–Ω—É
- `_getCurrentScreen()` - –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥–∂–µ—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –µ–∫—Ä–∞–Ω—É –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ `_selectedIndex`

---

## 2.2. `firebase_options.dart`

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é Firebase –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.

**–©–æ –º—ñ—Å—Ç–∏—Ç—å:**
- API –∫–ª—é—á—ñ –¥–ª—è Android, iOS, Web
- Project ID
- App ID –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏
- –Ü–Ω—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Firebase

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –¶–µ–π —Ñ–∞–π–ª –Ω–µ –≤–∞—Ä—Ç–æ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –≤—Ä—É—á–Ω—É, –≤—ñ–Ω –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–æ–º–∞–Ω–¥–æ—é:
```bash
flutterfire configure
```

---

# 3. CORE –ú–û–î–£–õ–Ü

## 3.1. `core/app_theme.dart` - –¢–µ–º–∏ —Ç–∞ –∫–æ–ª—å–æ—Ä–∏

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—ñ–≤ —Ç–∞ —Ç–µ–º –¥–æ–¥–∞—Ç–∫—É.

### –ö–æ–ª—å–æ—Ä–∏:

```dart
class AppTheme {
  static const Color primary = Color(0xFF6C5CE7);      // –û—Å–Ω–æ–≤–Ω–∏–π —Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π
  static const Color secondary = Color(0xFFA29BFE);    // –í—Ç–æ—Ä–∏–Ω–Ω–∏–π —Å–≤—ñ—Ç–ª–æ-—Ñ—ñ–æ–ª–µ—Ç–æ–≤–∏–π
  static const Color background = Color(0xFFF8F9FA);   // –§–æ–Ω —Å–≤—ñ—Ç–ª–∏–π
  static const Color textDark = Color(0xFF2D3436);     // –¢–µ–∫—Å—Ç —Ç–µ–º–Ω–∏–π
  static const Color accent = Color(0xFF00B894);       // –ê–∫—Ü–µ–Ω—Ç–Ω–∏–π –∑–µ–ª–µ–Ω–∏–π
  static const Color error = Color(0xFFD63031);        // –ü–æ–º–∏–ª–∫–∞ —á–µ—Ä–≤–æ–Ω–∏–π
}
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

```dart
Container(
  color: AppTheme.primary,
  child: Text(
    '–¢–µ–∫—Å—Ç',
    style: TextStyle(color: AppTheme.textDark),
  ),
)
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –õ–µ–≥–∫–æ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–ª—å–æ—Ä–∏ –≤—Å—å–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –¥–∏–∑–∞–π–Ω—É
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ Material Design 3

---

## 3.2. `core/auth_repository.dart` - –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ê–±—Å—Ç—Ä–∞–∫—Ü—ñ—è –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Firebase Authentication.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:

```dart
class AuthRepository {
  final FirebaseAuth _auth = FirebaseAuth.instance;
  
  User? get currentUser => _auth.currentUser;  // –ü–æ—Ç–æ—á–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á
  
  Future<UserCredential> signUp({...})         // –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
  Future<UserCredential> signIn({...})         // –í—Ö—ñ–¥
  Future<void> signOut()                       // –í–∏—Ö—ñ–¥
}
```

### –ú–µ—Ç–æ–¥–∏:

#### `signUp()` - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```dart
Future<UserCredential> signUp({
  required String email,
  required String password,
}) {
  return _auth.createUserWithEmailAndPassword(
    email: email,
    password: password,
  );
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –°—Ç–≤–æ—Ä—é—î –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ Firebase Authentication
- –ü–æ–≤–µ—Ä—Ç–∞—î `UserCredential` –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ú–æ–∂–µ –≤–∏–∫–∏–Ω—É—Ç–∏ `FirebaseAuthException` –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ

#### `signIn()` - –í—Ö—ñ–¥ —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```dart
Future<UserCredential> signIn({
  required String email,
  required String password,
}) {
  return _auth.signInWithEmailAndPassword(
    email: email,
    password: password,
  );
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ email —Ç–∞ –ø–∞—Ä–æ–ª–µ–º
- –°—Ç–≤–æ—Ä—é—î —Å–µ—Å—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ü–æ–≤–µ—Ä—Ç–∞—î `UserCredential`

#### `signOut()` - –í–∏—Ö—ñ–¥
```dart
Future<void> signOut() => _auth.signOut();
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ó–∞–≤–µ—Ä—à—É—î —Å–µ—Å—ñ—é –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –û—á–∏—â—É—î –ª–æ–∫–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

```dart
final authRepo = AuthRepository();

// –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —É–≤—ñ–π—à–æ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á
if (authRepo.currentUser != null) {
  print('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: ${authRepo.currentUser!.email}');
}

// –£–≤—ñ–π—Ç–∏
try {
  await authRepo.signIn(email: 'user@example.com', password: 'password');
} catch (e) {
  print('–ü–æ–º–∏–ª–∫–∞: $e');
}
```

---

## 3.3. `core/storage_service.dart` - –õ–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –°–µ—Ä–≤—ñ—Å –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó —á–µ—Ä–µ–∑ SharedPreferences.

### –ü–∞—Ç—Ç–µ—Ä–Ω Singleton:

```dart
class StorageService {
  static StorageService? _instance;
  SharedPreferences? _prefs;
  
  StorageService._(); // –ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
  
  static Future<StorageService> getInstance() async {
    _instance ??= StorageService._();
    _instance!._prefs ??= await SharedPreferences.getInstance();
    return _instance!;
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ó–∞–±–µ–∑–ø–µ—á—É—î —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä —Å–µ—Ä–≤—ñ—Å—É (Singleton pattern)
- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î SharedPreferences –æ–¥–∏–Ω —Ä–∞–∑

### –ú–µ—Ç–æ–¥–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏:

#### –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:

```dart
// –¢–µ–º–∞
Future<bool> setThemeMode(String mode) async {
  return await _prefs?.setString(_keyTheme, mode) ?? false;
}

// –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è
Future<bool> setNotificationsEnabled(bool enabled) async {
  return await _prefs?.setBool(_keyNotifications, enabled) ?? false;
}

// –ú–æ–≤–∞
Future<bool> setLanguage(String languageCode) async {
  return await _prefs?.setString(_keyLanguage, languageCode) ?? false;
}
```

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:

```dart
String getThemeMode() {
  return _prefs?.getString(_keyTheme) ?? 'system'; // –ó–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
}

bool getNotificationsEnabled() {
  return _prefs?.getBool(_keyNotifications) ?? true;
}

String getLanguage() {
  return _prefs?.getString(_keyLanguage) ?? 'uk';
}
```

### –ó–∞–≥–∞–ª—å–Ω—ñ –º–µ—Ç–æ–¥–∏:

```dart
// –†—è–¥–æ–∫
Future<bool> setString(String key, String value)
String? getString(String key)

// –ß–∏—Å–ª–æ
Future<bool> setInt(String key, int value)
int? getInt(String key)

// –ë—É–ª–µ–≤–µ
Future<bool> setBool(String key, bool value)
bool? getBool(String key)

// –°–ø–∏—Å–æ–∫
Future<bool> setStringList(String key, List<String> value)
List<String>? getStringList(String key)

// –í–∏–¥–∞–ª–µ–Ω–Ω—è
Future<bool> remove(String key)
Future<bool> clear()
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

```dart
final storage = await StorageService.getInstance();

// –ó–±–µ—Ä–µ–≥—Ç–∏
await storage.setThemeMode('dark');
await storage.setNotificationsEnabled(false);

// –û—Ç—Ä–∏–º–∞—Ç–∏
final theme = storage.getThemeMode();
final notifications = storage.getNotificationsEnabled();
```

---

# 4. FEATURES –ú–û–î–£–õ–Ü

## 4.1. –ú–æ–¥—É–ª—å Auth (`features/auth/`)

### 4.1.1. `auth_screen.dart` - –ï–∫—Ä–∞–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–æ—Ñ—ñ–ª—é

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ñ–æ—Ä–º—É –≤—Ö–æ–¥—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∞–±–æ –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:

```dart
class AuthScreen extends StatefulWidget {
  final VoidCallback? onLoginSuccess;  // –ö–æ–ª–±–µ–∫ –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ª–æ–≥—ñ–Ω—É
  
  const AuthScreen({super.key, this.onLoginSuccess});
}
```

#### –°—Ç–∞–Ω–∏:

- **–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π** - –ø–æ–∫–∞–∑—É—î —Ñ–æ—Ä–º—É –≤—Ö–æ–¥—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
- **–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π** - –ø–æ–∫–∞–∑—É—î –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏

#### –§–æ—Ä–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó:

```dart
Form(
  key: _formKey,
  child: Column(
    children: [
      TextFormField(
        controller: _emailController,
        validator: (value) {
          if (value == null || value.isEmpty || !value.contains('@')) {
            return '–í–≤–µ–¥—ñ—Ç—å –≤–∞–ª—ñ–¥–Ω–∏–π email';
          }
          return null;
        },
      ),
      TextFormField(
        controller: _passwordController,
        obscureText: true,
        validator: (value) {
          if (value == null || value.length < 6) {
            return '–ü–∞—Ä–æ–ª—å –º–∞—î –±—É—Ç–∏ –Ω–µ –º–µ–Ω—à–µ 6 —Å–∏–º–≤–æ–ª—ñ–≤';
          }
          return null;
        },
      ),
      ElevatedButton(
        onPressed: _submit,
        child: Text(_isLogin ? '–£–≤—ñ–π—Ç–∏' : '–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è'),
      ),
    ],
  ),
)
```

#### –ú–µ—Ç–æ–¥ `_submit()`:

```dart
Future<void> _submit() async {
  if (!_formKey.currentState!.validate()) return;
  
  setState(() => _isLoading = true);
  
  try {
    if (_isLogin) {
      await AuthRepository().signIn(
        email: _emailController.text.trim(),
        password: _passwordController.text.trim(),
      );
      FirebaseAnalytics.instance.logEvent(name: 'login');
    } else {
      await AuthRepository().signUp(
        email: _emailController.text.trim(),
        password: _passwordController.text.trim(),
      );
      FirebaseAnalytics.instance.logEvent(name: 'register');
    }
    
    widget.onLoginSuccess?.call(); // –í–∏–∫–ª–∏–∫–∞—î –∫–æ–ª–±–µ–∫
    setState(() {}); // –û–Ω–æ–≤–ª—é—î UI –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é
  } on FirebaseAuthException catch (e) {
    // –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
  } finally {
    setState(() => _isLoading = false);
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –í–∞–ª—ñ–¥—É—î —Ñ–æ—Ä–º—É
- –í–∏–∫–æ–Ω—É—î –≤—Ö—ñ–¥ –∞–±–æ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é
- –õ–æ–≥—É—î –ø–æ–¥—ñ—ó –≤ Firebase Analytics
- –í–∏–∫–ª–∏–∫–∞—î –∫–æ–ª–±–µ–∫ `onLoginSuccess` –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è –Ω–∞ –ø–µ—Ä—à—É –≤–∫–ª–∞–¥–∫—É
- –û–±—Ä–æ–±–ª—è—î –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –ø–æ–∫–∞–∑—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

#### –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

```dart
if (user != null) {
  return SafeArea(
    child: SingleChildScrollView(
      child: Column(
        children: [
          // –ê–≤–∞—Ç–∞—Ä —Ç–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è
          CircleAvatar(...),
          Text(user.email ?? ''),
          
          // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
          SettingsSection(),
          
          // –ö–Ω–æ–ø–∫–∞ –≤–∏—Ö–æ–¥—É
          ElevatedButton(
            onPressed: _signOut,
            child: Text('–í–∏–π—Ç–∏'),
          ),
        ],
      ),
    ),
  );
}
```

---

### 4.1.2. `settings_section.dart` - –°–µ–∫—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –í—ñ–¥–∂–µ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ –¥–æ–¥–∞—Ç–∫—É (—Ç–µ–º–∞, —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, –º–æ–≤–∞).

#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è StorageService:

```dart
class _SettingsSectionState extends State<SettingsSection> {
  late StorageService _storageService;
  bool _isDarkMode = false;
  bool _notificationsEnabled = true;
  String _selectedLanguage = 'uk';

  @override
  void initState() {
    super.initState();
    _loadSettings();
  }

  Future<void> _loadSettings() async {
    _storageService = await StorageService.getInstance();
    setState(() {
      _isDarkMode = _storageService.getThemeMode() == 'dark';
      _notificationsEnabled = _storageService.getNotificationsEnabled();
      _selectedLanguage = _storageService.getLanguage();
    });
  }
}
```

#### –ü–µ—Ä–µ–º–∏–∫–∞—á —Ç–µ–º–∏:

```dart
ListTile(
  title: Text('–¢–µ–º–Ω–∞ —Ç–µ–º–∞'),
  trailing: Switch(
    value: _isDarkMode,
    onChanged: (value) async {
      setState(() => _isDarkMode = value);
      await _storageService.setThemeMode(value ? 'dark' : 'light');
    },
  ),
)
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- –ó–±–µ—Ä—ñ–≥–∞—î –∑–º—ñ–Ω–∏ –≤ SharedPreferences
- –û–Ω–æ–≤–ª—é—î UI –ø—Ä–∏ –∑–º—ñ–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

---

## 4.2. –ú–æ–¥—É–ª—å Chats (`features/chats/`)

### 4.2.1. –ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö (`models/`)

#### `chat_model.dart` - –ú–æ–¥–µ–ª—å —á–∞—Ç—É

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –¥–∞–Ω—ñ –ø—Ä–æ —á–∞—Ç –≤ –æ–±'—î–∫—Ç–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ.

```dart
class ChatModel {
  final String id;                    // –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID —á–∞—Ç—É
  final String name;                  // –ù–∞–∑–≤–∞ —á–∞—Ç—É
  final String? createdBy;            // ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —Å—Ç–≤–æ—Ä–∏–≤
  final DateTime? createdAt;          // –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
  final DateTime? lastMessageTime;    // –ß–∞—Å –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  final LastMessage? lastMessage;     // –û—Å—Ç–∞–Ω–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
}
```

**–ú–µ—Ç–æ–¥–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó:**

1. **`fromFirestore()`** - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑ Firestore –¥–æ–∫—É–º–µ–Ω—Ç–∞
```dart
factory ChatModel.fromFirestore(String id, Map<String, dynamic> data) {
  return ChatModel(
    id: id,
    name: data['name'] as String? ?? '–ë–µ–∑ –Ω–∞–∑–≤–∏',
    createdBy: data['createdBy'] as String?,
    createdAt: (data['createdAt'] as Timestamp?)?.toDate(),
    lastMessageTime: (data['lastMessageTime'] as Timestamp?)?.toDate(),
    lastMessage: data['lastMessage'] != null
        ? LastMessage.fromMap(data['lastMessage'] as Map<String, dynamic>)
        : null,
  );
}
```

2. **`toJson()`** - –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤ JSON
```dart
Map<String, dynamic> toJson() {
  return {
    'id': id,
    'name': name,
    'createdBy': createdBy,
    'createdAt': createdAt?.toIso8601String(),
    'lastMessageTime': lastMessageTime?.toIso8601String(),
    'lastMessage': lastMessage?.toMap(),
  };
}
```

3. **`copyWith()`** - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–ø—ñ—ó –∑ –æ–Ω–æ–≤–ª–µ–Ω–∏–º–∏ –ø–æ–ª—è–º–∏
```dart
ChatModel copyWith({
  String? id,
  String? name,
  // ... —ñ–Ω—à—ñ –ø–æ–ª—è
}) {
  return ChatModel(
    id: id ?? this.id,
    name: name ?? this.name,
    // ...
  );
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –Ü–Ω–∫–∞–ø—Å—É–ª—é—î –¥–∞–Ω—ñ —á–∞—Ç—É
- –ó–∞–±–µ–∑–ø–µ—á—É—î —Ç–∏–ø–æ–±–µ–∑–ø–µ–∫—É
- –°–ø—Ä–æ—â—É—î —Ä–æ–±–æ—Ç—É –∑ –¥–∞–Ω–∏–º–∏ –≤ –∫–æ–¥—ñ

---

#### `message_model.dart` - –ú–æ–¥–µ–ª—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —á–∞—Ç—ñ.

```dart
class MessageModel {
  final String id;
  final String text;
  final String sender;
  final String senderId;
  final DateTime timestamp;
  final Map<String, List<String>> reactions;  // –†–µ–∞–∫—Ü—ñ—ó (–µ–º–æ–¥–∑—ñ -> —Å–ø–∏—Å–æ–∫ UID)
  final String? imageUrl;
  final String? fileUrl;
}
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:**
- –ü—ñ–¥—Ç—Ä–∏–º—É—î —Ä–µ–∞–∫—Ü—ñ—ó –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- –ú–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –º–µ–¥—ñ–∞ (–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, —Ñ–∞–π–ª–∏)
- –ö–æ–Ω–≤–µ—Ä—Ç—É—î—Ç—å—Å—è –∑/–≤ Firestore —Ñ–æ—Ä–º–∞—Ç

---

### 4.2.2. –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó (`repositories/`)

#### `chats_repository.dart` - –†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —á–∞—Ç–∞–º–∏

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ê–±—Å—Ç—Ä–∞–∫—Ü—ñ—è –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —á–∞—Ç–∞–º–∏ –≤ Firestore.

**–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**

```dart
abstract class ChatsRepository {
  Future<List<ChatModel>> getChats();                    // –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫
  Stream<List<ChatModel>> getChatsStream();              // –ü–æ—Ç—ñ–∫ –¥–ª—è real-time
  Future<ChatModel?> getChatById(String chatId);         // –û—Ç—Ä–∏–º–∞—Ç–∏ –æ–¥–∏–Ω
  Future<String> createChat({required String name});     // –°—Ç–≤–æ—Ä–∏—Ç–∏
  Future<void> updateChat({required String chatId, String? name}); // –û–Ω–æ–≤–∏—Ç–∏
  Future<void> deleteChat(String chatId);                // –í–∏–¥–∞–ª–∏—Ç–∏
  Future<void> updateLastMessage({...});                 // –û–Ω–æ–≤–∏—Ç–∏ lastMessage
}
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ Firestore:**

```dart
class FirestoreChatsRepository implements ChatsRepository {
  final FirebaseFirestore _firestore;
  final FirebaseAuth _auth;

  @override
  Future<List<ChatModel>> getChats() async {
    final snapshot = await _firestore
        .collection('chat_rooms')
        .orderBy('lastMessageTime', descending: true)
        .get();

    return snapshot.docs.map((doc) {
      return ChatModel.fromFirestore(doc.id, doc.data() as Map<String, dynamic>);
    }).toList();
  }

  @override
  Stream<List<ChatModel>> getChatsStream() {
    return _firestore
        .collection('chat_rooms')
        .snapshots()
        .map((snapshot) {
      final chats = snapshot.docs.map((doc) {
        return ChatModel.fromFirestore(doc.id, doc.data());
      }).toList();

      // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
      chats.sort((a, b) {
        if (a.lastMessageTime != null && b.lastMessageTime != null) {
          return b.lastMessageTime!.compareTo(a.lastMessageTime!);
        }
        // ...
        return 0;
      });

      return chats;
    });
  }

  @override
  Future<String> createChat({required String name}) async {
    final user = _auth.currentUser;
    if (user == null) {
      throw Exception('–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π');
    }

    final docRef = await _firestore.collection('chat_rooms').add({
      'name': name,
      'createdBy': user.uid,
      'createdAt': FieldValue.serverTimestamp(),
      'lastMessage': null,
      'lastMessageTime': null,
    });

    return docRef.id;
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –Ü–Ω–∫–∞–ø—Å—É–ª—é—î –ª–æ–≥—ñ–∫—É —Ä–æ–±–æ—Ç–∏ –∑ Firestore
- –ö–æ–Ω–≤–µ—Ä—Ç—É—î Firestore –¥–∞–Ω—ñ –≤ –º–æ–¥–µ–ª—ñ
- –û–±—Ä–æ–±–ª—è—î –ø–æ–º–∏–ª–∫–∏
- –ó–∞–±–µ–∑–ø–µ—á—É—î —Ç–∏–ø–æ–±–µ–∑–ø–µ–∫—É

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ (–º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ mock-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π)
- –ú–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ Firestore –Ω–∞ —ñ–Ω—à–µ –¥–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö
- –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏

---

### 4.2.3. BLoC (`bloc/`)

#### `chats_bloc.dart` - BLoC –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω–æ–º —á–∞—Ç—ñ–≤

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ö–µ—Ä—É—î —Å—Ç–∞–Ω–æ–º —Å–ø–∏—Å–∫—É —á–∞—Ç—ñ–≤, –æ–±—Ä–æ–±–ª—è—î –ø–æ–¥—ñ—ó —Ç–∞ –µ–º—ñ—Ç—É—î —Å—Ç–∞–Ω–∏.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```dart
class ChatsBloc extends Bloc<ChatsEvent, ChatsState> {
  final ChatsRepository _chatsRepository;

  ChatsBloc({
    ChatsRepository? chatsRepository,
  })  : _chatsRepository = chatsRepository ?? FirestoreChatsRepository(),
        super(const ChatsInitialState()) {
    on<LoadChatsEvent>(_onLoadChatsEvent);
    on<RefreshChatsEvent>(_onRefreshChatsEvent);
    on<CreateChatEvent>(_onCreateChatEvent);
  }
}
```

**–û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:**

```dart
Future<void> _onLoadChatsEvent(
  LoadChatsEvent event,
  Emitter<ChatsState> emit,
) async {
  emit(ChatsLoadingState(data: state.data)); // –ü–æ–∫–∞–∑—É—î–º–æ loading

  try {
    // –°–ø–æ—á–∞—Ç–∫—É –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ –æ–¥–∏–Ω —Ä–∞–∑
    final chats = await _chatsRepository.getChats();
    emit(ChatsDataState(data: chats));
    
    // –ü–æ—Ç—ñ–º –ø—ñ–¥–ø–∏—Å—É—î–º–æ—Å—è –Ω–∞ –ø–æ—Ç—ñ–∫ –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
    await emit.forEach(
      _chatsRepository.getChatsStream(),
      onData: (updatedChats) => ChatsDataState(data: updatedChats),
      onError: (error, stackTrace) => ChatsErrorState(
        error: error.toString(),
        data: state.data,
      ),
    );
  } catch (e) {
    emit(ChatsErrorState(
      error: e.toString(),
      data: state.data,
    ));
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
1. –ï–º—ñ—Ç—É—î loading —Å—Ç–∞–Ω –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ –¥–∞–Ω–∏–º–∏
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –¥–∞–Ω—ñ –æ–¥–∏–Ω —Ä–∞–∑
3. –ü—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è –Ω–∞ Stream –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
4. –û–±—Ä–æ–±–ª—è—î –ø–æ–º–∏–ª–∫–∏

**–û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (pull-to-refresh):**

```dart
Future<void> _onRefreshChatsEvent(...) async {
  emit(ChatsLoadingState(data: state.data));
  
  try {
    final chats = await _chatsRepository.getChats();
    emit(ChatsDataState(data: chats));
  } catch (e) {
    emit(ChatsErrorState(error: e.toString(), data: state.data));
  }
}
```

**–û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∞—Ç—É:**

```dart
Future<void> _onCreateChatEvent(...) async {
  try {
    await _chatsRepository.createChat(name: event.chatName);
    add(const RefreshChatsEvent()); // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫
  } catch (e) {
    emit(ChatsErrorState(error: '–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∞—Ç—É: ${e.toString()}'));
  }
}
```

---

#### `create_chat_bloc.dart` - BLoC –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∞—Ç—É

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ö–µ—Ä—É—î —Å—Ç–∞–Ω–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —á–∞—Ç—É.

**–ü–æ–¥—ñ—ó:**

```dart
class CreateChatRequestedEvent extends CreateChatEvent {
  final String chatName;
  const CreateChatRequestedEvent(this.chatName);
}

class CreateChatResetEvent extends CreateChatEvent {
  const CreateChatResetEvent();
}
```

**–°—Ç–∞–Ω–∏:**

```dart
class CreateChatInitialState extends CreateChatState {}
class CreateChatCreatingState extends CreateChatState {}      // Loading
class CreateChatSuccessState extends CreateChatState {        // –£—Å–ø—ñ—Ö
  final String chatId;
  final String chatName;
}
class CreateChatErrorState extends CreateChatState {          // –ü–æ–º–∏–ª–∫–∞
  final String error;
}
```

**–û–±—Ä–æ–±–∫–∞:**

```dart
Future<void> _onCreateChatRequested(...) async {
  emit(const CreateChatCreatingState());
  
  try {
    final chatId = await _chatsRepository.createChat(
      name: event.chatName,
    );
    
    emit(CreateChatSuccessState(
      chatId: chatId,
      chatName: event.chatName,
    ));
  } catch (e) {
    emit(CreateChatErrorState(e.toString()));
  }
}
```

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ UI:**

```dart
BlocConsumer<CreateChatBloc, CreateChatState>(
  listener: (context, state) {
    if (state is CreateChatSuccessState) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('–ß–∞—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ!')),
      );
      context.read<CreateChatBloc>().add(const CreateChatResetEvent());
    }
  },
  builder: (context, state) {
    if (state is CreateChatCreatingState) {
      return CircularProgressIndicator();
    }
    return ElevatedButton(
      onPressed: () {
        context.read<CreateChatBloc>().add(
          CreateChatRequestedEvent('–ù–æ–≤–∏–π —á–∞—Ç'),
        );
      },
      child: Text('–°—Ç–≤–æ—Ä–∏—Ç–∏'),
    );
  },
)
```

---

### 4.2.4. –ï–∫—Ä–∞–Ω–∏

#### `chats_screen.dart` - –ï–∫—Ä–∞–Ω —Å–ø–∏—Å–∫—É —á–∞—Ç—ñ–≤

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö —á–∞—Ç—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```dart
class ChatsScreen extends StatefulWidget {
  const ChatsScreen({super.key});
}

class _ChatsScreenState extends State<ChatsScreen> {
  final _auth = FirebaseAuth.instance;
  final _seedData = ChatSeedData();
  bool _hasInitialized = false;
}
```

**–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª:**

```dart
@override
void initState() {
  super.initState();
  _initializeChats();
  context.read<ChatsBloc>().add(const LoadChatsEvent());
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î —Ç–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —á–∞—Ç–∏ —á–µ—Ä–µ–∑ BLoC

**–í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É:**

```dart
BlocBuilder<ChatsBloc, ChatsState>(
  builder: (context, state) {
    if (state is ChatsLoadingState && state.data.isEmpty) {
      return Center(child: CircularProgressIndicator());
    }
    
    if (state is ChatsErrorState) {
      return Center(
        child: Column(
          children: [
            Text('–ü–æ–º–∏–ª–∫–∞: ${state.error}'),
            ElevatedButton(
              onPressed: () {
                context.read<ChatsBloc>().add(const LoadChatsEvent());
              },
              child: Text('–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É'),
            ),
          ],
        ),
      );
    }
    
    final chats = state is ChatsDataState ? state.data : [];
    
    return RefreshIndicator(
      onRefresh: () async {
        context.read<ChatsBloc>().add(const RefreshChatsEvent());
      },
      child: ListView.builder(
        itemCount: chats.length,
        itemBuilder: (context, index) {
          final chat = chats[index];
          return Card(
            child: ListTile(
              title: Text(chat.name),
              subtitle: Text(_getLastMessagePreview(chat.lastMessage)),
              trailing: Text(_formatTime(chat.lastMessageTime)),
              onTap: () {
                Navigator.push(
                  context,
                  MaterialPageRoute(
                    builder: (_) => ChatRoomScreen(
                      chatId: chat.id,
                      chatName: chat.name,
                    ),
                  ),
                );
              },
            ),
          );
        },
      ),
    );
  },
)
```

**–ú–µ—Ç–æ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —á–∞—Ç—É:**

```dart
Future<void> _createChatRoom() async {
  final nameController = TextEditingController();
  
  final result = await showDialog<String>(
    context: context,
    builder: (context) => AlertDialog(
      title: Text('–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —á–∞—Ç'),
      content: TextField(
        controller: nameController,
        autofocus: true,
      ),
      actions: [
        TextButton(
          onPressed: () => Navigator.pop(context),
          child: Text('–°–∫–∞—Å—É–≤–∞—Ç–∏'),
        ),
        TextButton(
          onPressed: () => Navigator.pop(context, nameController.text),
          child: Text('–°—Ç–≤–æ—Ä–∏—Ç–∏'),
        ),
      ],
    ),
  );
  
  if (result != null && result.isNotEmpty) {
    context.read<ChatsBloc>().add(CreateChatEvent(result));
  }
}
```

---

#### `chat_room_screen.dart` - –ï–∫—Ä–∞–Ω –æ–∫—Ä–µ–º–æ–≥–æ —á–∞—Ç—É

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç—É —Ç–∞ –¥–æ–∑–≤–æ–ª—è—î –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –Ω–æ–≤—ñ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```dart
class ChatRoomScreen extends StatefulWidget {
  final String chatId;
  final String chatName;
  
  const ChatRoomScreen({
    super.key,
    required this.chatId,
    required this.chatName,
  });
}
```

**–í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:**

```dart
StreamBuilder<QuerySnapshot>(
  stream: FirebaseFirestore.instance
      .collection('chat_rooms')
      .doc(chatId)
      .collection('messages')
      .orderBy('timestamp', descending: true)
      .snapshots(),
  builder: (context, snapshot) {
    if (!snapshot.hasData) {
      return Center(child: CircularProgressIndicator());
    }
    
    final messages = snapshot.data!.docs;
    
    return ListView.builder(
      reverse: true, // –ù–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–Ω–∏–∑—É
      itemCount: messages.length,
      itemBuilder: (context, index) {
        final message = messages[index].data() as Map<String, dynamic>;
        return MessageBubble(
          text: message['text'],
          sender: message['sender'],
          isMe: message['senderId'] == currentUser.uid,
        );
      },
    );
  },
)
```

**–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:**

```dart
Future<void> _sendMessage() async {
  final text = _messageController.text.trim();
  if (text.isEmpty) return;
  
  final user = FirebaseAuth.instance.currentUser;
  if (user == null) return;
  
  try {
    // –î–æ–¥–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
    await FirebaseFirestore.instance
        .collection('chat_rooms')
        .doc(chatId)
        .collection('messages')
        .add({
      'text': text,
      'sender': user.email,
      'senderId': user.uid,
      'timestamp': FieldValue.serverTimestamp(),
    });
    
    // –û–Ω–æ–≤–∏—Ç–∏ lastMessage –≤ —á–∞—Ç—ñ
    await FirebaseFirestore.instance
        .collection('chat_rooms')
        .doc(chatId)
        .update({
      'lastMessage': {
        'text': text,
        'sender': user.email,
      },
      'lastMessageTime': FieldValue.serverTimestamp(),
    });
    
    _messageController.clear();
  } catch (e) {
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('–ü–æ–º–∏–ª–∫–∞: $e')),
    );
  }
}
```

---

### 4.2.5. –°–ø—ñ–ª—å–Ω—ñ –≤—ñ–¥–∂–µ—Ç–∏

#### `widgets/message_bubble.dart` - –ë—É–ª—å–±–∞—à–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –æ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ —á–∞—Ç—ñ.

```dart
class MessageBubble extends StatelessWidget {
  final String text;
  final String sender;
  final bool isMe;
  
  const MessageBubble({
    super.key,
    required this.text,
    required this.sender,
    required this.isMe,
  });

  @override
  Widget build(BuildContext context) {
    return Align(
      alignment: isMe ? Alignment.centerRight : Alignment.centerLeft,
      child: Container(
        padding: EdgeInsets.symmetric(horizontal: 16, vertical: 10),
        margin: EdgeInsets.symmetric(vertical: 4, horizontal: 8),
        decoration: BoxDecoration(
          color: isMe ? Colors.blue : Colors.grey[300],
          borderRadius: BorderRadius.circular(16),
        ),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            if (!isMe)
              Text(
                sender,
                style: TextStyle(
                  fontSize: 12,
                  fontWeight: FontWeight.bold,
                ),
              ),
            Text(text),
          ],
        ),
      ),
    );
  }
}
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –í—ñ–¥–æ–±—Ä–∞–∂–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —Ä—ñ–∑–Ω–∏–º —Å—Ç–∏–ª–µ–º –¥–ª—è "–º–æ—ó—Ö" —Ç–∞ "—á—É–∂–∏—Ö"
- –í–∏—Ä—ñ–≤–Ω—é—î —Å–ø—Ä–∞–≤–∞ –¥–ª—è —Å–≤–æ—ó—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, –∑–ª—ñ–≤–∞ –¥–ª—è —á—É–∂–∏—Ö
- –ü–æ–∫–∞–∑—É—î –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞ –¥–ª—è —á—É–∂–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

---

## 4.3. –ú–æ–¥—É–ª—å Contacts (`features/contacts/`)

### 4.3.1. `contacts_screen.dart` - –ï–∫—Ä–∞–Ω —Å–ø–∏—Å–∫—É –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –í—ñ–¥–æ–±—Ä–∞–∂–∞—î —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ —É –≤–∏–≥–ª—è–¥—ñ —Å—ñ—Ç–∫–∏ –∑ –ø–æ—à—É–∫–æ–º —Ç–∞ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è–º.

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:**

1. **–ü–æ—à—É–∫ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤**
```dart
final _searchController = TextEditingController();
String _searchQuery = '';

void _onSearchChanged(String value) {
  setState(() {
    _searchQuery = value.toLowerCase();
  });
}
```

2. **–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è**
```dart
enum SortOption { name, email, online }

SortOption _sortOption = SortOption.name;

List<ContactModel> get _filteredAndSortedContacts {
  var contacts = List<ContactModel>.from(_contacts);
  
  // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è
  if (_searchQuery.isNotEmpty) {
    contacts = contacts.where((contact) {
      return contact.name.toLowerCase().contains(_searchQuery) ||
             contact.email.toLowerCase().contains(_searchQuery);
    }).toList();
  }
  
  // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
  contacts.sort((a, b) {
    switch (_sortOption) {
      case SortOption.name:
        return a.name.compareTo(b.name);
      case SortOption.email:
        return a.email.compareTo(b.email);
      case SortOption.online:
        return (b.isOnline ? 1 : 0).compareTo(a.isOnline ? 1 : 0);
    }
  });
  
  return contacts;
}
```

3. **GridView –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è**
```dart
GridView.builder(
  gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
    crossAxisCount: 2,
    crossAxisSpacing: 8,
    mainAxisSpacing: 8,
  ),
  itemCount: _filteredAndSortedContacts.length,
  itemBuilder: (context, index) {
    final contact = _filteredAndSortedContacts[index];
    return _buildContactCard(contact);
  },
)
```

---

# 5. –ó–í'–Ø–ó–ö–ò –ú–Ü–ñ –ö–û–ú–ü–û–ù–ï–ù–¢–ê–ú–ò

## 5.1. –ü–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö

```
UI (Screen)
    ‚Üì
BLoC (Event)
    ‚Üì
Repository
    ‚Üì
Firestore
    ‚Üì
Repository (Stream/Future)
    ‚Üì
BLoC (State)
    ‚Üì
UI (Rebuild)
```

**–ü—Ä–∏–∫–ª–∞–¥: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∞—Ç—É**

1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î –∫–Ω–æ–ø–∫—É "–°—Ç–≤–æ—Ä–∏—Ç–∏ —á–∞—Ç"
2. UI –≤–∏–∫–ª–∏–∫–∞—î: `context.read<ChatsBloc>().add(CreateChatEvent(name))`
3. BLoC –æ–±—Ä–æ–±–ª—è—î –ø–æ–¥—ñ—é —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—î: `_chatsRepository.createChat(name)`
4. Repository –¥–æ–¥–∞—î —á–∞—Ç –≤ Firestore
5. Firestore –µ–º—ñ—Ç—É—î –∑–º—ñ–Ω—É —á–µ—Ä–µ–∑ Stream
6. Repository –∫–æ–Ω–≤–µ—Ä—Ç—É—î –¥–∞–Ω—ñ –≤ `ChatModel`
7. BLoC –µ–º—ñ—Ç—É—î `ChatsDataState` –∑ –Ω–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏
8. UI –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `BlocBuilder`

---

## 5.2. –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

```
main.dart
    ‚îú‚îÄ‚îÄ MultiBlocProvider
    ‚îÇ       ‚îî‚îÄ‚îÄ ChatsBloc
    ‚îÇ               ‚îî‚îÄ‚îÄ ChatsRepository
    ‚îÇ                       ‚îî‚îÄ‚îÄ FirebaseFirestore
    ‚îÇ
    ‚îî‚îÄ‚îÄ MainWrapper
            ‚îú‚îÄ‚îÄ ChatsScreen
            ‚îÇ       ‚îî‚îÄ‚îÄ BlocBuilder<ChatsBloc>
            ‚îÇ
            ‚îú‚îÄ‚îÄ ContactsScreen
            ‚îÇ
            ‚îî‚îÄ‚îÄ AuthScreen
                    ‚îú‚îÄ‚îÄ AuthRepository
                    ‚îî‚îÄ‚îÄ StorageService
```

---

# üìù –ü–†–ò–ö–õ–ê–î–ò –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø

## –ü—Ä–∏–∫–ª–∞–¥ 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–∞—Ç—ñ–≤

```dart
// –í UI
BlocBuilder<ChatsBloc, ChatsState>(
  builder: (context, state) {
    if (state is ChatsLoadingState) {
      return CircularProgressIndicator();
    }
    
    if (state is ChatsDataState) {
      return ListView.builder(
        itemCount: state.data.length,
        itemBuilder: (context, index) {
          return ChatListItem(chat: state.data[index]);
        },
      );
    }
    
    return SizedBox();
  },
)

// –í BLoC
context.read<ChatsBloc>().add(const LoadChatsEvent());
```

---

## –ü—Ä–∏–∫–ª–∞–¥ 2: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∞—Ç—É

```dart
// –í UI
context.read<ChatsBloc>().add(CreateChatEvent('–ù–æ–≤–∏–π —á–∞—Ç'));

// –í BLoC
Future<void> _onCreateChatEvent(...) async {
  await _chatsRepository.createChat(name: event.chatName);
  add(const RefreshChatsEvent());
}

// –í Repository
Future<String> createChat({required String name}) async {
  final docRef = await _firestore.collection('chat_rooms').add({
    'name': name,
    'createdBy': user.uid,
    'createdAt': FieldValue.serverTimestamp(),
  });
  return docRef.id;
}
```

---

## –ü—Ä–∏–∫–ª–∞–¥ 3: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

```dart
// –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Ä–≤—ñ—Å
final storage = await StorageService.getInstance();

// –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
await storage.setThemeMode('dark');
await storage.setNotificationsEnabled(false);
await storage.setLanguage('uk');

// –û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
final theme = storage.getThemeMode();
final notifications = storage.getNotificationsEnabled();
final language = storage.getLanguage();
```

---

# ‚úÖ –®–í–ò–î–ö–ê –î–û–í–Ü–î–ö–ê

## –ö–ª—é—á–æ–≤—ñ —Ñ–∞–π–ª–∏:

1. **`main.dart`** - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É, —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Firebase, –Ω–∞–≤—ñ–≥–∞—Ü—ñ—è
2. **`core/app_theme.dart`** - –∫–æ–ª—å–æ—Ä–∏ —Ç–∞ —Ç–µ–º–∏
3. **`core/auth_repository.dart`** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
4. **`core/storage_service.dart`** - –ª–æ–∫–∞–ª—å–Ω–µ —Å—Ö–æ–≤–∏—â–µ
5. **`features/chats/bloc/chats_bloc.dart`** - –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω–æ–º —á–∞—Ç—ñ–≤
6. **`features/chats/repositories/chats_repository.dart`** - —Ä–æ–±–æ—Ç–∞ –∑ Firestore
7. **`features/chats/models/chat_model.dart`** - –º–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö —á–∞—Ç—É

## –ü–∞—Ç—Ç–µ—Ä–Ω–∏:

1. **Repository Pattern** - –∞–±—Å—Ç—Ä–∞–∫—Ü—ñ—è –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∞–Ω–∏—Ö
2. **BLoC Pattern** - –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω–æ–º
3. **Singleton Pattern** - StorageService
4. **Factory Pattern** - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π –∑ Firestore

---

**–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** 2025  
**–í–µ—Ä—Å—ñ—è:** 1.0  
**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∫–æ–¥—É –ø—Ä–æ—î–∫—Ç—É MiniChat


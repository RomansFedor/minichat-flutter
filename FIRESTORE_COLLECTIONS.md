# –ö–æ–ª–µ–∫—Ü—ñ—ó Firestore Database

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö

### 1. –ö–æ–ª–µ–∫—Ü—ñ—è: `chat_rooms`

–ö–æ–ª–µ–∫—Ü—ñ—è —á–∞—Ç—ñ–≤, —â–æ –º—ñ—Å—Ç–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —á–∞—Ç-–∫—ñ–º–Ω–∞—Ç–∏.

**–ü–æ–ª—è:**
- `name` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - –Ω–∞–∑–≤–∞ —á–∞—Ç—É
- `createdBy` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - UID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —Å—Ç–≤–æ—Ä–∏–≤ —á–∞—Ç
- `createdAt` (Timestamp, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - –¥–∞—Ç–∞ —Ç–∞ —á–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–∞—Ç—É
- `lastMessage` (Map, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –æ—Å—Ç–∞–Ω–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  - `text` (String) - —Ç–µ–∫—Å—Ç –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  - `sender` (String) - email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
- `lastMessageTime` (Timestamp, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - —á–∞—Å –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `participants` (Array<String>, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - —Å–ø–∏—Å–æ–∫ UID —É—á–∞—Å–Ω–∏–∫—ñ–≤ —á–∞—Ç—É

**–ü—Ä–∏–∫–ª–∞–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "name": "–ü—Ä–æ–µ–∫—Ç–Ω–∏–π —á–∞—Ç",
  "createdBy": "user123uid",
  "createdAt": "2025-01-15T10:30:00Z",
  "lastMessage": {
    "text": "–ü—Ä–∏–≤—ñ—Ç —É—Å—ñ–º!",
    "sender": "user@example.com"
  },
  "lastMessageTime": "2025-01-15T14:20:00Z"
}
```

---

### 2. –ü—ñ–¥–∫–æ–ª–µ–∫—Ü—ñ—è: `chat_rooms/{chatId}/messages`

–ü—ñ–¥–∫–æ–ª–µ–∫—Ü—ñ—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ —á–∞—Ç—É.

**–ü–æ–ª—è:**
- `text` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - —Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `sender` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
- `senderId` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - UID –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
- `timestamp` (Timestamp, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - —á–∞—Å –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `reactions` (Map<String, Array<String>>, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - —Ä–µ–∞–∫—Ü—ñ—ó –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  - –ö–ª—é—á: –µ–º–æ–¥–∑—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "‚ù§Ô∏è", "üòÇ")
  - –ó–Ω–∞—á–µ–Ω–Ω—è: –º–∞—Å–∏–≤ UID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –ø–æ—Å—Ç–∞–≤–∏–ª–∏ —Ä–µ–∞–∫—Ü—ñ—é
- `isEdited` (Boolean, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - —á–∏ –±—É–ª–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–µ
- `editedAt` (Timestamp, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - —á–∞—Å —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è

**–ü—Ä–∏–∫–ª–∞–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "text": "–ü—Ä–∏–≤—ñ—Ç! –Ø–∫ —Å–ø—Ä–∞–≤–∏?",
  "sender": "user@example.com",
  "senderId": "user123uid",
  "timestamp": "2025-01-15T14:20:00Z",
  "reactions": {
    "‚ù§Ô∏è": ["user456uid", "user789uid"],
    "üëç": ["user123uid"]
  },
  "isEdited": false
}
```

---

### 3. –ö–æ–ª–µ–∫—Ü—ñ—è: `saved_messages`

–ö–æ–ª–µ–∫—Ü—ñ—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

**–ü–æ–ª—è:**
- `userId` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - UID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –∑–±–µ—Ä—ñ–≥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `messageId` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - ID –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `chatId` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - ID —á–∞—Ç—É, –∑ —è–∫–æ–≥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `messageText` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - —Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `sender` (String, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `savedAt` (Timestamp, –æ–±–æ–≤'—è–∑–∫–æ–≤–µ) - —á–∞—Å –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `note` (String, –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ) - –ø—Ä–∏–º—ñ—Ç–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

**–ü—Ä–∏–∫–ª–∞–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞:**
```json
{
  "userId": "user123uid",
  "messageId": "msg456id",
  "chatId": "chat789id",
  "messageText": "–í–∞–∂–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø—Ä–æ–µ–∫—Ç",
  "sender": "manager@example.com",
  "savedAt": "2025-01-15T15:00:00Z",
  "note": "–ü–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Ü—å–æ–≥–æ –ø—ñ–∑–Ω—ñ—à–µ"
}
```

---

## –î—ñ–∞–≥—Ä–∞–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∫–æ–ª–µ–∫—Ü—ñ–π

```
Firestore Database
‚îÇ
‚îú‚îÄ‚îÄ chat_rooms (–∫–æ–ª–µ–∫—Ü—ñ—è)
‚îÇ   ‚îú‚îÄ‚îÄ {chatId1} (–¥–æ–∫—É–º–µ–Ω—Ç)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ name: "–ß–∞—Ç 1"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ createdBy: "user123"
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ createdAt: Timestamp
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ messages (–ø—ñ–¥–∫–æ–ª–µ–∫—Ü—ñ—è)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ {messageId1}
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ text: "–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è 1"
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ sender: "user@example.com"
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ timestamp: Timestamp
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ {messageId2}
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ {chatId2} (–¥–æ–∫—É–º–µ–Ω—Ç)
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ saved_messages (–∫–æ–ª–µ–∫—Ü—ñ—è)
    ‚îú‚îÄ‚îÄ {savedMessageId1}
    ‚îÇ   ‚îú‚îÄ‚îÄ userId: "user123"
    ‚îÇ   ‚îú‚îÄ‚îÄ messageId: "msg456"
    ‚îÇ   ‚îî‚îÄ‚îÄ savedAt: Timestamp
    ‚îî‚îÄ‚îÄ {savedMessageId2}
        ‚îî‚îÄ‚îÄ ...
```

---

## –Ü–Ω–¥–µ–∫—Å–∏

–î–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏:

1. **chat_rooms:**
   - `lastMessageTime` (descending) - –¥–ª—è —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —á–∞—Ç—ñ–≤ –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º
   - `createdAt` (descending) - –¥–ª—è —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –¥–∞—Ç–æ—é —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
   - –ö–æ–º–ø–æ–∑–∏—Ç–Ω–∏–π: `createdBy` + `createdAt` - –¥–ª—è –ø–æ—à—É–∫—É —á–∞—Ç—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

2. **messages:**
   - `timestamp` (descending) - –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É —Ö—Ä–æ–Ω–æ–ª–æ–≥—ñ—á–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É
   - –ö–æ–º–ø–æ–∑–∏—Ç–Ω–∏–π: `senderId` + `timestamp` - –¥–ª—è –ø–æ—à—É–∫—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

3. **saved_messages:**
   - `userId` + `savedAt` (descending) - –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   - `chatId` - –¥–ª—è –ø–æ—à—É–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç—É

---

**–î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** 2025  
**–í–µ—Ä—Å—ñ—è:** 1.0

